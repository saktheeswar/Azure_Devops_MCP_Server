pipelines:
  branches:
    master:
      - step:
          name: Build and Deploy on Private Server
          runs-on:
            - self.hosted
            - linux
          image: node:18.19.1
          script:
            - echo "Installing dependencies..."
            - npm install
            - npm run test
            - npm run build
            - pm2 stop nestapp || true
            - pm2 start dist/main.js --name nestapp
            - pm2 save
